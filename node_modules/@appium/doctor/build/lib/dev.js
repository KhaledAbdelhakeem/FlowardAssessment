"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.BinaryIsInPathCheck = exports.AndroidSdkExists = void 0;

require("source-map-support/register");

var _doctor = require("./doctor");

var _utils = require("./utils");

var _support = require("@appium/support");

var _path = _interopRequireDefault(require("path"));

require("@colors/colors");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

let checks = [];

class BinaryIsInPathCheck extends _doctor.DoctorCheck {
  constructor(binary) {
    super();
    this.binary = binary;
  }

  async diagnose() {
    const resolvedPath = await (0, _utils.resolveExecutablePath)(this.binary);

    if (!resolvedPath) {
      return (0, _utils.nok)(`${this.binary} is MISSING in PATH: ${process.env.PATH}`);
    }

    return (0, _utils.ok)(`${this.binary} was found at ${resolvedPath}`);
  }

  fix() {
    return `Manually install the ${this.binary.bold} binary and add it to ${'PATH'.bold}.`;
  }

}

exports.BinaryIsInPathCheck = BinaryIsInPathCheck;
checks.push(new BinaryIsInPathCheck(_support.system.isWindows() ? 'mvn.bat' : 'mvn'));
checks.push(new BinaryIsInPathCheck(_support.system.isWindows() ? 'ant.bat' : 'ant'));
checks.push(new BinaryIsInPathCheck(_support.system.isWindows() ? 'adb.exe' : 'adb'));

class AndroidSdkExists extends _doctor.DoctorCheck {
  constructor(sdk) {
    super();
    this.sdk = sdk;
  }

  async diagnose() {
    if (typeof process.env.ANDROID_HOME === 'undefined') {
      return (0, _utils.nok)(`${this.sdk} could not be found because ANDROID_HOME is NOT set!`);
    }

    let sdkPath = _path.default.resolve(process.env.ANDROID_HOME, _path.default.join('platforms', this.sdk));

    return (await _support.fs.exists(sdkPath)) ? (0, _utils.ok)(`${this.sdk} was found at: ${sdkPath}`) : (0, _utils.nok)(`${this.sdk} could NOT be found at '${sdkPath}'!`);
  }

  fix() {
    if (typeof process.env.ANDROID_HOME === 'undefined') {
      return `Manually configure ${'ANDROID_HOME'.bold}.`;
    }

    return `Manually install the ${this.sdk.bold} sdk.`;
  }

}

exports.AndroidSdkExists = AndroidSdkExists;
checks.push(new AndroidSdkExists('android-16'));
checks.push(new AndroidSdkExists('android-19'));
var _default = checks;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjaGVja3MiLCJCaW5hcnlJc0luUGF0aENoZWNrIiwiRG9jdG9yQ2hlY2siLCJjb25zdHJ1Y3RvciIsImJpbmFyeSIsImRpYWdub3NlIiwicmVzb2x2ZWRQYXRoIiwicmVzb2x2ZUV4ZWN1dGFibGVQYXRoIiwibm9rIiwicHJvY2VzcyIsImVudiIsIlBBVEgiLCJvayIsImZpeCIsImJvbGQiLCJwdXNoIiwic3lzdGVtIiwiaXNXaW5kb3dzIiwiQW5kcm9pZFNka0V4aXN0cyIsInNkayIsIkFORFJPSURfSE9NRSIsInNka1BhdGgiLCJwYXRoIiwicmVzb2x2ZSIsImpvaW4iLCJmcyIsImV4aXN0cyJdLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9kZXYuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtEb2N0b3JDaGVja30gZnJvbSAnLi9kb2N0b3InO1xuaW1wb3J0IHtvaywgbm9rLCByZXNvbHZlRXhlY3V0YWJsZVBhdGh9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHtmcywgc3lzdGVtfSBmcm9tICdAYXBwaXVtL3N1cHBvcnQnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgJ0Bjb2xvcnMvY29sb3JzJztcblxubGV0IGNoZWNrcyA9IFtdO1xuXG4vLyBDaGVjayBQQVRIIGJpbmFyaWVzXG5jbGFzcyBCaW5hcnlJc0luUGF0aENoZWNrIGV4dGVuZHMgRG9jdG9yQ2hlY2sge1xuICBjb25zdHJ1Y3RvcihiaW5hcnkpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuYmluYXJ5ID0gYmluYXJ5O1xuICB9XG5cbiAgYXN5bmMgZGlhZ25vc2UoKSB7XG4gICAgY29uc3QgcmVzb2x2ZWRQYXRoID0gYXdhaXQgcmVzb2x2ZUV4ZWN1dGFibGVQYXRoKHRoaXMuYmluYXJ5KTtcbiAgICBpZiAoIXJlc29sdmVkUGF0aCkge1xuICAgICAgcmV0dXJuIG5vayhgJHt0aGlzLmJpbmFyeX0gaXMgTUlTU0lORyBpbiBQQVRIOiAke3Byb2Nlc3MuZW52LlBBVEh9YCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9rKGAke3RoaXMuYmluYXJ5fSB3YXMgZm91bmQgYXQgJHtyZXNvbHZlZFBhdGh9YCk7XG4gIH1cblxuICBmaXgoKSB7XG4gICAgcmV0dXJuIGBNYW51YWxseSBpbnN0YWxsIHRoZSAke3RoaXMuYmluYXJ5LmJvbGR9IGJpbmFyeSBhbmQgYWRkIGl0IHRvICR7J1BBVEgnLmJvbGR9LmA7XG4gIH1cbn1cblxuY2hlY2tzLnB1c2gobmV3IEJpbmFyeUlzSW5QYXRoQ2hlY2soc3lzdGVtLmlzV2luZG93cygpID8gJ212bi5iYXQnIDogJ212bicpKTtcbmNoZWNrcy5wdXNoKG5ldyBCaW5hcnlJc0luUGF0aENoZWNrKHN5c3RlbS5pc1dpbmRvd3MoKSA/ICdhbnQuYmF0JyA6ICdhbnQnKSk7XG5jaGVja3MucHVzaChuZXcgQmluYXJ5SXNJblBhdGhDaGVjayhzeXN0ZW0uaXNXaW5kb3dzKCkgPyAnYWRiLmV4ZScgOiAnYWRiJykpO1xuXG4vLyBDaGVjayBBbmRyb2lkIFNES3NcbmNsYXNzIEFuZHJvaWRTZGtFeGlzdHMgZXh0ZW5kcyBEb2N0b3JDaGVjayB7XG4gIGNvbnN0cnVjdG9yKHNkaykge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5zZGsgPSBzZGs7XG4gIH1cblxuICBhc3luYyBkaWFnbm9zZSgpIHtcbiAgICBpZiAodHlwZW9mIHByb2Nlc3MuZW52LkFORFJPSURfSE9NRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJldHVybiBub2soYCR7dGhpcy5zZGt9IGNvdWxkIG5vdCBiZSBmb3VuZCBiZWNhdXNlIEFORFJPSURfSE9NRSBpcyBOT1Qgc2V0IWApO1xuICAgIH1cbiAgICBsZXQgc2RrUGF0aCA9IHBhdGgucmVzb2x2ZShwcm9jZXNzLmVudi5BTkRST0lEX0hPTUUsIHBhdGguam9pbigncGxhdGZvcm1zJywgdGhpcy5zZGspKTtcbiAgICByZXR1cm4gKGF3YWl0IGZzLmV4aXN0cyhzZGtQYXRoKSlcbiAgICAgID8gb2soYCR7dGhpcy5zZGt9IHdhcyBmb3VuZCBhdDogJHtzZGtQYXRofWApXG4gICAgICA6IG5vayhgJHt0aGlzLnNka30gY291bGQgTk9UIGJlIGZvdW5kIGF0ICcke3Nka1BhdGh9JyFgKTtcbiAgfVxuXG4gIGZpeCgpIHtcbiAgICBpZiAodHlwZW9mIHByb2Nlc3MuZW52LkFORFJPSURfSE9NRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJldHVybiBgTWFudWFsbHkgY29uZmlndXJlICR7J0FORFJPSURfSE9NRScuYm9sZH0uYDtcbiAgICB9XG4gICAgcmV0dXJuIGBNYW51YWxseSBpbnN0YWxsIHRoZSAke3RoaXMuc2RrLmJvbGR9IHNkay5gO1xuICB9XG59XG5cbmNoZWNrcy5wdXNoKG5ldyBBbmRyb2lkU2RrRXhpc3RzKCdhbmRyb2lkLTE2JykpO1xuY2hlY2tzLnB1c2gobmV3IEFuZHJvaWRTZGtFeGlzdHMoJ2FuZHJvaWQtMTknKSk7XG5cbmV4cG9ydCB7QmluYXJ5SXNJblBhdGhDaGVjaywgQW5kcm9pZFNka0V4aXN0c307XG5leHBvcnQgZGVmYXVsdCBjaGVja3M7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUEsSUFBSUEsTUFBTSxHQUFHLEVBQWI7O0FBR0EsTUFBTUMsbUJBQU4sU0FBa0NDLG1CQUFsQyxDQUE4QztFQUM1Q0MsV0FBVyxDQUFDQyxNQUFELEVBQVM7SUFDbEI7SUFDQSxLQUFLQSxNQUFMLEdBQWNBLE1BQWQ7RUFDRDs7RUFFYSxNQUFSQyxRQUFRLEdBQUc7SUFDZixNQUFNQyxZQUFZLEdBQUcsTUFBTSxJQUFBQyw0QkFBQSxFQUFzQixLQUFLSCxNQUEzQixDQUEzQjs7SUFDQSxJQUFJLENBQUNFLFlBQUwsRUFBbUI7TUFDakIsT0FBTyxJQUFBRSxVQUFBLEVBQUssR0FBRSxLQUFLSixNQUFPLHdCQUF1QkssT0FBTyxDQUFDQyxHQUFSLENBQVlDLElBQUssRUFBM0QsQ0FBUDtJQUNEOztJQUVELE9BQU8sSUFBQUMsU0FBQSxFQUFJLEdBQUUsS0FBS1IsTUFBTyxpQkFBZ0JFLFlBQWEsRUFBL0MsQ0FBUDtFQUNEOztFQUVETyxHQUFHLEdBQUc7SUFDSixPQUFRLHdCQUF1QixLQUFLVCxNQUFMLENBQVlVLElBQUsseUJBQXdCLE9BQU9BLElBQUssR0FBcEY7RUFDRDs7QUFqQjJDOzs7QUFvQjlDZCxNQUFNLENBQUNlLElBQVAsQ0FBWSxJQUFJZCxtQkFBSixDQUF3QmUsZUFBQSxDQUFPQyxTQUFQLEtBQXFCLFNBQXJCLEdBQWlDLEtBQXpELENBQVo7QUFDQWpCLE1BQU0sQ0FBQ2UsSUFBUCxDQUFZLElBQUlkLG1CQUFKLENBQXdCZSxlQUFBLENBQU9DLFNBQVAsS0FBcUIsU0FBckIsR0FBaUMsS0FBekQsQ0FBWjtBQUNBakIsTUFBTSxDQUFDZSxJQUFQLENBQVksSUFBSWQsbUJBQUosQ0FBd0JlLGVBQUEsQ0FBT0MsU0FBUCxLQUFxQixTQUFyQixHQUFpQyxLQUF6RCxDQUFaOztBQUdBLE1BQU1DLGdCQUFOLFNBQStCaEIsbUJBQS9CLENBQTJDO0VBQ3pDQyxXQUFXLENBQUNnQixHQUFELEVBQU07SUFDZjtJQUNBLEtBQUtBLEdBQUwsR0FBV0EsR0FBWDtFQUNEOztFQUVhLE1BQVJkLFFBQVEsR0FBRztJQUNmLElBQUksT0FBT0ksT0FBTyxDQUFDQyxHQUFSLENBQVlVLFlBQW5CLEtBQW9DLFdBQXhDLEVBQXFEO01BQ25ELE9BQU8sSUFBQVosVUFBQSxFQUFLLEdBQUUsS0FBS1csR0FBSSxzREFBaEIsQ0FBUDtJQUNEOztJQUNELElBQUlFLE9BQU8sR0FBR0MsYUFBQSxDQUFLQyxPQUFMLENBQWFkLE9BQU8sQ0FBQ0MsR0FBUixDQUFZVSxZQUF6QixFQUF1Q0UsYUFBQSxDQUFLRSxJQUFMLENBQVUsV0FBVixFQUF1QixLQUFLTCxHQUE1QixDQUF2QyxDQUFkOztJQUNBLE9BQU8sQ0FBQyxNQUFNTSxXQUFBLENBQUdDLE1BQUgsQ0FBVUwsT0FBVixDQUFQLElBQ0gsSUFBQVQsU0FBQSxFQUFJLEdBQUUsS0FBS08sR0FBSSxrQkFBaUJFLE9BQVEsRUFBeEMsQ0FERyxHQUVILElBQUFiLFVBQUEsRUFBSyxHQUFFLEtBQUtXLEdBQUksMkJBQTBCRSxPQUFRLElBQWxELENBRko7RUFHRDs7RUFFRFIsR0FBRyxHQUFHO0lBQ0osSUFBSSxPQUFPSixPQUFPLENBQUNDLEdBQVIsQ0FBWVUsWUFBbkIsS0FBb0MsV0FBeEMsRUFBcUQ7TUFDbkQsT0FBUSxzQkFBcUIsZUFBZU4sSUFBSyxHQUFqRDtJQUNEOztJQUNELE9BQVEsd0JBQXVCLEtBQUtLLEdBQUwsQ0FBU0wsSUFBSyxPQUE3QztFQUNEOztBQXJCd0M7OztBQXdCM0NkLE1BQU0sQ0FBQ2UsSUFBUCxDQUFZLElBQUlHLGdCQUFKLENBQXFCLFlBQXJCLENBQVo7QUFDQWxCLE1BQU0sQ0FBQ2UsSUFBUCxDQUFZLElBQUlHLGdCQUFKLENBQXFCLFlBQXJCLENBQVo7ZUFHZWxCLE0ifQ==