"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.fixes = exports.default = exports.XcodeCmdLineToolsCheck = exports.XcodeCheck = exports.OptionalLyftCommandCheck = exports.OptionalIdbCommandCheck = exports.OptionalIOSDeployCommandCheck = exports.OptionalApplesimutilsCommandCheck = exports.DevToolsSecurityCheck = void 0;

require("source-map-support/register");

var _utils = require("./utils");

var _support = require("@appium/support");

var _teen_process = require("teen_process");

var _doctor = require("./doctor");

var _logger = _interopRequireDefault(require("./logger"));

var _prompt = require("./prompt");

var _env = _interopRequireDefault(require("./env"));

require("@colors/colors");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

let checks = [];
let fixes = {};
exports.fixes = fixes;

class XcodeCheck extends _doctor.DoctorCheck {
  async diagnose() {
    let xcodePath;

    try {
      await (0, _teen_process.exec)('xcrun', ['simctl', 'help']);
    } catch (err) {
      return (0, _utils.nok)('Error running xcrun simctl');
    }

    try {
      const {
        stdout
      } = await (0, _teen_process.exec)('xcode-select', ['-p']);
      xcodePath = (stdout || '').replace('\n', '');
    } catch (err) {
      return (0, _utils.nok)('Xcode is NOT installed!');
    }

    return xcodePath && (await _support.fs.exists(xcodePath)) ? (0, _utils.ok)(`Xcode is installed at: ${xcodePath}`) : (0, _utils.nok)(`Xcode cannot be found at '${xcodePath}'!`);
  }

  async fix() {
    return `Manually install ${'Xcode'.bold}, and make sure 'xcode-select -p' command shows proper path like '/Applications/Xcode.app/Contents/Developer'`;
  }

}

exports.XcodeCheck = XcodeCheck;
checks.push(new XcodeCheck());

class XcodeCmdLineToolsCheck extends _doctor.DoctorCheck {
  constructor() {
    super({
      autofix: true
    });
  }

  async diagnose() {
    const errMess = 'Xcode Command Line Tools are NOT installed!';

    try {
      const stdout = (await (0, _teen_process.exec)('xcode-select', ['-p'])).stdout;
      return (0, _utils.ok)(`Xcode Command Line Tools are installed in: ${stdout.trim()}`);
    } catch (err) {
      _logger.default.debug(err);

      return (0, _utils.nok)(errMess);
    }
  }

  async fix() {
    _logger.default.info(`The following command need be executed: xcode-select --install`);

    let yesno = await (0, _prompt.fixIt)();

    if (yesno === 'yes') {
      await (0, _teen_process.exec)('xcode-select', ['--install']);
    } else {
      _logger.default.info(`Skipping you will need to install ${'Xcode'.bold} manually.`);

      throw new _doctor.FixSkippedError();
    }
  }

}

exports.XcodeCmdLineToolsCheck = XcodeCmdLineToolsCheck;
checks.push(new XcodeCmdLineToolsCheck());

class DevToolsSecurityCheck extends _doctor.DoctorCheck {
  async diagnose() {
    const errMess = 'DevToolsSecurity is NOT enabled!';
    let stdout;

    try {
      stdout = (await (0, _teen_process.exec)('DevToolsSecurity', [])).stdout;
    } catch (err) {
      _logger.default.debug(err);

      return (0, _utils.nok)(errMess);
    }

    return stdout && stdout.match(/enabled/) ? (0, _utils.ok)('DevToolsSecurity is enabled.') : (0, _utils.nok)(errMess);
  }

}

exports.DevToolsSecurityCheck = DevToolsSecurityCheck;
checks.push(new DevToolsSecurityCheck());
checks.push(new _env.default('HOME'));

class OptionalLyftCommandCheck extends _doctor.DoctorCheck {
  async diagnose() {
    const lyftCmd = await (0, _utils.resolveExecutablePath)('set-simulator-location');

    if (lyftCmd) {
      return (0, _utils.okOptional)('set-simulator-location is installed');
    }

    return (0, _utils.nokOptional)('set-simulator-location is not installed');
  }

  async fix() {
    return `${'set-simulator-location'.bold} is needed to set location for Simulator. ` + 'Please read https://github.com/lyft/set-simulator-location to install it';
  }

}

exports.OptionalLyftCommandCheck = OptionalLyftCommandCheck;
checks.push(new OptionalLyftCommandCheck());

class OptionalIdbCommandCheck extends _doctor.DoctorCheck {
  async diagnose() {
    const fbIdbPath = await (0, _utils.resolveExecutablePath)('idb');
    const fbCompanionIdbPath = await (0, _utils.resolveExecutablePath)('idb_companion');

    if (fbIdbPath && fbCompanionIdbPath) {
      return (0, _utils.okOptional)('idb and idb_companion are installed');
    }

    if (!fbIdbPath && fbCompanionIdbPath) {
      return (0, _utils.nokOptional)('idb is not installed');
    } else if (fbIdbPath && !fbCompanionIdbPath) {
      return (0, _utils.nokOptional)('idb_companion is not installed');
    }

    return (0, _utils.nokOptional)('idb and idb_companion are not installed');
  }

  async fix() {
    return `Why ${'idb'.bold} is needed and how to install it: ${OptionalIdbCommandCheck.idbReadmeURL}`;
  }

}

exports.OptionalIdbCommandCheck = OptionalIdbCommandCheck;
OptionalIdbCommandCheck.idbReadmeURL = 'https://git.io/JnxQc';
checks.push(new OptionalIdbCommandCheck());

class OptionalApplesimutilsCommandCheck extends _doctor.DoctorCheck {
  async diagnose() {
    const applesimutilsPath = await (0, _utils.resolveExecutablePath)('applesimutils');
    return applesimutilsPath ? (0, _utils.okOptional)(`applesimutils is installed at: ${applesimutilsPath}. Installed versions are: ${(await (0, _teen_process.exec)('brew', ['list', '--versions', 'applesimutils'])).stdout.trim()}`) : (0, _utils.nokOptional)('applesimutils cannot be found');
  }

  async fix() {
    return `Why ${'applesimutils'.bold} is needed and how to install it: http://appium.io/docs/en/drivers/ios-xcuitest/`;
  }

}

exports.OptionalApplesimutilsCommandCheck = OptionalApplesimutilsCommandCheck;
checks.push(new OptionalApplesimutilsCommandCheck());

class OptionalIOSDeployCommandCheck extends _doctor.DoctorCheck {
  async diagnose() {
    const iosDeployPath = await (0, _utils.resolveExecutablePath)('ios-deploy');
    return iosDeployPath ? (0, _utils.okOptional)(`ios-deploy is installed at: ${iosDeployPath}. Installed version is: ${(await (0, _teen_process.exec)(iosDeployPath, ['-V'])).stdout.trim()}`) : (0, _utils.nokOptional)('ios-deploy cannot be found');
  }

  async fix() {
    return `${'ios-deploy'.bold} is used as a fallback command to install iOS applications to real device. Please read https://github.com/ios-control/ios-deploy/ to install it`;
  }

}

exports.OptionalIOSDeployCommandCheck = OptionalIOSDeployCommandCheck;
checks.push(new OptionalIOSDeployCommandCheck());
var _default = checks;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjaGVja3MiLCJmaXhlcyIsIlhjb2RlQ2hlY2siLCJEb2N0b3JDaGVjayIsImRpYWdub3NlIiwieGNvZGVQYXRoIiwiZXhlYyIsImVyciIsIm5vayIsInN0ZG91dCIsInJlcGxhY2UiLCJmcyIsImV4aXN0cyIsIm9rIiwiZml4IiwiYm9sZCIsInB1c2giLCJYY29kZUNtZExpbmVUb29sc0NoZWNrIiwiY29uc3RydWN0b3IiLCJhdXRvZml4IiwiZXJyTWVzcyIsInRyaW0iLCJsb2ciLCJkZWJ1ZyIsImluZm8iLCJ5ZXNubyIsImZpeEl0IiwiRml4U2tpcHBlZEVycm9yIiwiRGV2VG9vbHNTZWN1cml0eUNoZWNrIiwibWF0Y2giLCJFbnZWYXJBbmRQYXRoQ2hlY2siLCJPcHRpb25hbEx5ZnRDb21tYW5kQ2hlY2siLCJseWZ0Q21kIiwicmVzb2x2ZUV4ZWN1dGFibGVQYXRoIiwib2tPcHRpb25hbCIsIm5va09wdGlvbmFsIiwiT3B0aW9uYWxJZGJDb21tYW5kQ2hlY2siLCJmYklkYlBhdGgiLCJmYkNvbXBhbmlvbklkYlBhdGgiLCJpZGJSZWFkbWVVUkwiLCJPcHRpb25hbEFwcGxlc2ltdXRpbHNDb21tYW5kQ2hlY2siLCJhcHBsZXNpbXV0aWxzUGF0aCIsIk9wdGlvbmFsSU9TRGVwbG95Q29tbWFuZENoZWNrIiwiaW9zRGVwbG95UGF0aCJdLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9pb3MuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtvaywgbm9rLCBva09wdGlvbmFsLCBub2tPcHRpb25hbCwgcmVzb2x2ZUV4ZWN1dGFibGVQYXRofSBmcm9tICcuL3V0aWxzJzsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuaW1wb3J0IHtmc30gZnJvbSAnQGFwcGl1bS9zdXBwb3J0JztcbmltcG9ydCB7ZXhlY30gZnJvbSAndGVlbl9wcm9jZXNzJztcbmltcG9ydCB7RG9jdG9yQ2hlY2ssIEZpeFNraXBwZWRFcnJvcn0gZnJvbSAnLi9kb2N0b3InO1xuaW1wb3J0IGxvZyBmcm9tICcuL2xvZ2dlcic7XG5pbXBvcnQge2ZpeEl0fSBmcm9tICcuL3Byb21wdCc7XG5pbXBvcnQgRW52VmFyQW5kUGF0aENoZWNrIGZyb20gJy4vZW52JztcbmltcG9ydCAnQGNvbG9ycy9jb2xvcnMnO1xuXG5sZXQgY2hlY2tzID0gW107XG5sZXQgZml4ZXMgPSB7fTtcblxuLy8gQ2hlY2sgZm9yIFhjb2RlLlxuY2xhc3MgWGNvZGVDaGVjayBleHRlbmRzIERvY3RvckNoZWNrIHtcbiAgYXN5bmMgZGlhZ25vc2UoKSB7XG4gICAgbGV0IHhjb2RlUGF0aDtcbiAgICB0cnkge1xuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0vaXNzdWVzLzEyMDkzI2lzc3VlY29tbWVudC00NTkzNTgxMjAgY2FuIGhhcHBlblxuICAgICAgYXdhaXQgZXhlYygneGNydW4nLCBbJ3NpbWN0bCcsICdoZWxwJ10pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIG5vaygnRXJyb3IgcnVubmluZyB4Y3J1biBzaW1jdGwnKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYygneGNvZGUtc2VsZWN0JywgWyctcCddKTtcbiAgICAgIHhjb2RlUGF0aCA9IChzdGRvdXQgfHwgJycpLnJlcGxhY2UoJ1xcbicsICcnKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiBub2soJ1hjb2RlIGlzIE5PVCBpbnN0YWxsZWQhJyk7XG4gICAgfVxuICAgIHJldHVybiB4Y29kZVBhdGggJiYgKGF3YWl0IGZzLmV4aXN0cyh4Y29kZVBhdGgpKVxuICAgICAgPyBvayhgWGNvZGUgaXMgaW5zdGFsbGVkIGF0OiAke3hjb2RlUGF0aH1gKVxuICAgICAgOiBub2soYFhjb2RlIGNhbm5vdCBiZSBmb3VuZCBhdCAnJHt4Y29kZVBhdGh9JyFgKTtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZXF1aXJlLWF3YWl0XG4gIGFzeW5jIGZpeCgpIHtcbiAgICByZXR1cm4gYE1hbnVhbGx5IGluc3RhbGwgJHtcbiAgICAgICdYY29kZScuYm9sZFxuICAgIH0sIGFuZCBtYWtlIHN1cmUgJ3hjb2RlLXNlbGVjdCAtcCcgY29tbWFuZCBzaG93cyBwcm9wZXIgcGF0aCBsaWtlICcvQXBwbGljYXRpb25zL1hjb2RlLmFwcC9Db250ZW50cy9EZXZlbG9wZXInYDtcbiAgfVxufVxuY2hlY2tzLnB1c2gobmV3IFhjb2RlQ2hlY2soKSk7XG5cbi8vIENoZWNrIGZvciBYY29kZSBDb21tYW5kIExpbmUgVG9vbHMuXG5jbGFzcyBYY29kZUNtZExpbmVUb29sc0NoZWNrIGV4dGVuZHMgRG9jdG9yQ2hlY2sge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcih7YXV0b2ZpeDogdHJ1ZX0pO1xuICB9XG5cbiAgYXN5bmMgZGlhZ25vc2UoKSB7XG4gICAgY29uc3QgZXJyTWVzcyA9ICdYY29kZSBDb21tYW5kIExpbmUgVG9vbHMgYXJlIE5PVCBpbnN0YWxsZWQhJztcbiAgICB0cnkge1xuICAgICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTUzNzE5MjUvaG93LXRvLWNoZWNrLWlmLWNvbW1hbmQtbGluZS10b29scy1pcy1pbnN0YWxsZWRcbiAgICAgIGNvbnN0IHN0ZG91dCA9IChhd2FpdCBleGVjKCd4Y29kZS1zZWxlY3QnLCBbJy1wJ10pKS5zdGRvdXQ7XG4gICAgICByZXR1cm4gb2soYFhjb2RlIENvbW1hbmQgTGluZSBUb29scyBhcmUgaW5zdGFsbGVkIGluOiAke3N0ZG91dC50cmltKCl9YCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBsb2cuZGVidWcoZXJyKTtcbiAgICAgIHJldHVybiBub2soZXJyTWVzcyk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZml4KCkge1xuICAgIGxvZy5pbmZvKGBUaGUgZm9sbG93aW5nIGNvbW1hbmQgbmVlZCBiZSBleGVjdXRlZDogeGNvZGUtc2VsZWN0IC0taW5zdGFsbGApO1xuICAgIGxldCB5ZXNubyA9IGF3YWl0IGZpeEl0KCk7XG4gICAgaWYgKHllc25vID09PSAneWVzJykge1xuICAgICAgYXdhaXQgZXhlYygneGNvZGUtc2VsZWN0JywgWyctLWluc3RhbGwnXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvZy5pbmZvKGBTa2lwcGluZyB5b3Ugd2lsbCBuZWVkIHRvIGluc3RhbGwgJHsnWGNvZGUnLmJvbGR9IG1hbnVhbGx5LmApO1xuICAgICAgdGhyb3cgbmV3IEZpeFNraXBwZWRFcnJvcigpO1xuICAgIH1cbiAgfVxufVxuXG5jaGVja3MucHVzaChuZXcgWGNvZGVDbWRMaW5lVG9vbHNDaGVjaygpKTtcblxuLy8gRGV2IFRvb2xzIFNlY3VyaXR5XG5jbGFzcyBEZXZUb29sc1NlY3VyaXR5Q2hlY2sgZXh0ZW5kcyBEb2N0b3JDaGVjayB7XG4gIGFzeW5jIGRpYWdub3NlKCkge1xuICAgIGNvbnN0IGVyck1lc3MgPSAnRGV2VG9vbHNTZWN1cml0eSBpcyBOT1QgZW5hYmxlZCEnO1xuICAgIGxldCBzdGRvdXQ7XG4gICAgdHJ5IHtcbiAgICAgIHN0ZG91dCA9IChhd2FpdCBleGVjKCdEZXZUb29sc1NlY3VyaXR5JywgW10pKS5zdGRvdXQ7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBsb2cuZGVidWcoZXJyKTtcbiAgICAgIHJldHVybiBub2soZXJyTWVzcyk7XG4gICAgfVxuICAgIHJldHVybiBzdGRvdXQgJiYgc3Rkb3V0Lm1hdGNoKC9lbmFibGVkLykgPyBvaygnRGV2VG9vbHNTZWN1cml0eSBpcyBlbmFibGVkLicpIDogbm9rKGVyck1lc3MpO1xuICB9XG59XG5jaGVja3MucHVzaChuZXcgRGV2VG9vbHNTZWN1cml0eUNoZWNrKCkpO1xuXG5jaGVja3MucHVzaChuZXcgRW52VmFyQW5kUGF0aENoZWNrKCdIT01FJykpO1xuXG5jbGFzcyBPcHRpb25hbEx5ZnRDb21tYW5kQ2hlY2sgZXh0ZW5kcyBEb2N0b3JDaGVjayB7XG4gIGFzeW5jIGRpYWdub3NlKCkge1xuICAgIGNvbnN0IGx5ZnRDbWQgPSBhd2FpdCByZXNvbHZlRXhlY3V0YWJsZVBhdGgoJ3NldC1zaW11bGF0b3ItbG9jYXRpb24nKTtcbiAgICBpZiAobHlmdENtZCkge1xuICAgICAgcmV0dXJuIG9rT3B0aW9uYWwoJ3NldC1zaW11bGF0b3ItbG9jYXRpb24gaXMgaW5zdGFsbGVkJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5va09wdGlvbmFsKCdzZXQtc2ltdWxhdG9yLWxvY2F0aW9uIGlzIG5vdCBpbnN0YWxsZWQnKTtcbiAgfVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVxdWlyZS1hd2FpdFxuICBhc3luYyBmaXgoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIGAkeydzZXQtc2ltdWxhdG9yLWxvY2F0aW9uJy5ib2xkfSBpcyBuZWVkZWQgdG8gc2V0IGxvY2F0aW9uIGZvciBTaW11bGF0b3IuIGAgK1xuICAgICAgJ1BsZWFzZSByZWFkIGh0dHBzOi8vZ2l0aHViLmNvbS9seWZ0L3NldC1zaW11bGF0b3ItbG9jYXRpb24gdG8gaW5zdGFsbCBpdCdcbiAgICApO1xuICB9XG59XG5jaGVja3MucHVzaChuZXcgT3B0aW9uYWxMeWZ0Q29tbWFuZENoZWNrKCkpO1xuXG5jbGFzcyBPcHRpb25hbElkYkNvbW1hbmRDaGVjayBleHRlbmRzIERvY3RvckNoZWNrIHtcbiAgYXN5bmMgZGlhZ25vc2UoKSB7XG4gICAgY29uc3QgZmJJZGJQYXRoID0gYXdhaXQgcmVzb2x2ZUV4ZWN1dGFibGVQYXRoKCdpZGInKTtcbiAgICBjb25zdCBmYkNvbXBhbmlvbklkYlBhdGggPSBhd2FpdCByZXNvbHZlRXhlY3V0YWJsZVBhdGgoJ2lkYl9jb21wYW5pb24nKTtcbiAgICBpZiAoZmJJZGJQYXRoICYmIGZiQ29tcGFuaW9uSWRiUGF0aCkge1xuICAgICAgcmV0dXJuIG9rT3B0aW9uYWwoJ2lkYiBhbmQgaWRiX2NvbXBhbmlvbiBhcmUgaW5zdGFsbGVkJyk7XG4gICAgfVxuXG4gICAgaWYgKCFmYklkYlBhdGggJiYgZmJDb21wYW5pb25JZGJQYXRoKSB7XG4gICAgICByZXR1cm4gbm9rT3B0aW9uYWwoJ2lkYiBpcyBub3QgaW5zdGFsbGVkJyk7XG4gICAgfSBlbHNlIGlmIChmYklkYlBhdGggJiYgIWZiQ29tcGFuaW9uSWRiUGF0aCkge1xuICAgICAgcmV0dXJuIG5va09wdGlvbmFsKCdpZGJfY29tcGFuaW9uIGlzIG5vdCBpbnN0YWxsZWQnKTtcbiAgICB9XG4gICAgcmV0dXJuIG5va09wdGlvbmFsKCdpZGIgYW5kIGlkYl9jb21wYW5pb24gYXJlIG5vdCBpbnN0YWxsZWQnKTtcbiAgfVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVxdWlyZS1hd2FpdFxuICBhc3luYyBmaXgoKSB7XG4gICAgcmV0dXJuIGBXaHkgJHsnaWRiJy5ib2xkfSBpcyBuZWVkZWQgYW5kIGhvdyB0byBpbnN0YWxsIGl0OiAke1xuICAgICAgT3B0aW9uYWxJZGJDb21tYW5kQ2hlY2suaWRiUmVhZG1lVVJMXG4gICAgfWA7XG4gIH1cbn1cbi8vIGxpbmsgdG8gaWRiIFJFQURNRS5tZFxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0taW9zL2Jsb2IvbWFpbi9wYWNrYWdlcy9pZGIvUkVBRE1FLm1kXG5PcHRpb25hbElkYkNvbW1hbmRDaGVjay5pZGJSZWFkbWVVUkwgPSAnaHR0cHM6Ly9naXQuaW8vSm54UWMnO1xuY2hlY2tzLnB1c2gobmV3IE9wdGlvbmFsSWRiQ29tbWFuZENoZWNrKCkpO1xuXG5jbGFzcyBPcHRpb25hbEFwcGxlc2ltdXRpbHNDb21tYW5kQ2hlY2sgZXh0ZW5kcyBEb2N0b3JDaGVjayB7XG4gIGFzeW5jIGRpYWdub3NlKCkge1xuICAgIGNvbnN0IGFwcGxlc2ltdXRpbHNQYXRoID0gYXdhaXQgcmVzb2x2ZUV4ZWN1dGFibGVQYXRoKCdhcHBsZXNpbXV0aWxzJyk7XG4gICAgcmV0dXJuIGFwcGxlc2ltdXRpbHNQYXRoXG4gICAgICA/IG9rT3B0aW9uYWwoXG4gICAgICAgICAgYGFwcGxlc2ltdXRpbHMgaXMgaW5zdGFsbGVkIGF0OiAke2FwcGxlc2ltdXRpbHNQYXRofS4gSW5zdGFsbGVkIHZlcnNpb25zIGFyZTogJHsoXG4gICAgICAgICAgICBhd2FpdCBleGVjKCdicmV3JywgWydsaXN0JywgJy0tdmVyc2lvbnMnLCAnYXBwbGVzaW11dGlscyddKVxuICAgICAgICAgICkuc3Rkb3V0LnRyaW0oKX1gXG4gICAgICAgIClcbiAgICAgIDogbm9rT3B0aW9uYWwoJ2FwcGxlc2ltdXRpbHMgY2Fubm90IGJlIGZvdW5kJyk7XG4gIH1cblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVxdWlyZS1hd2FpdFxuICBhc3luYyBmaXgoKSB7XG4gICAgcmV0dXJuIGBXaHkgJHtcbiAgICAgICdhcHBsZXNpbXV0aWxzJy5ib2xkXG4gICAgfSBpcyBuZWVkZWQgYW5kIGhvdyB0byBpbnN0YWxsIGl0OiBodHRwOi8vYXBwaXVtLmlvL2RvY3MvZW4vZHJpdmVycy9pb3MteGN1aXRlc3QvYDtcbiAgfVxufVxuY2hlY2tzLnB1c2gobmV3IE9wdGlvbmFsQXBwbGVzaW11dGlsc0NvbW1hbmRDaGVjaygpKTtcblxuY2xhc3MgT3B0aW9uYWxJT1NEZXBsb3lDb21tYW5kQ2hlY2sgZXh0ZW5kcyBEb2N0b3JDaGVjayB7XG4gIGFzeW5jIGRpYWdub3NlKCkge1xuICAgIGNvbnN0IGlvc0RlcGxveVBhdGggPSBhd2FpdCByZXNvbHZlRXhlY3V0YWJsZVBhdGgoJ2lvcy1kZXBsb3knKTtcbiAgICByZXR1cm4gaW9zRGVwbG95UGF0aFxuICAgICAgPyBva09wdGlvbmFsKFxuICAgICAgICAgIGBpb3MtZGVwbG95IGlzIGluc3RhbGxlZCBhdDogJHtpb3NEZXBsb3lQYXRofS4gSW5zdGFsbGVkIHZlcnNpb24gaXM6ICR7KFxuICAgICAgICAgICAgYXdhaXQgZXhlYyhpb3NEZXBsb3lQYXRoLCBbJy1WJ10pXG4gICAgICAgICAgKS5zdGRvdXQudHJpbSgpfWBcbiAgICAgICAgKVxuICAgICAgOiBub2tPcHRpb25hbCgnaW9zLWRlcGxveSBjYW5ub3QgYmUgZm91bmQnKTtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZXF1aXJlLWF3YWl0XG4gIGFzeW5jIGZpeCgpIHtcbiAgICByZXR1cm4gYCR7XG4gICAgICAnaW9zLWRlcGxveScuYm9sZFxuICAgIH0gaXMgdXNlZCBhcyBhIGZhbGxiYWNrIGNvbW1hbmQgdG8gaW5zdGFsbCBpT1MgYXBwbGljYXRpb25zIHRvIHJlYWwgZGV2aWNlLiBQbGVhc2UgcmVhZCBodHRwczovL2dpdGh1Yi5jb20vaW9zLWNvbnRyb2wvaW9zLWRlcGxveS8gdG8gaW5zdGFsbCBpdGA7XG4gIH1cbn1cbmNoZWNrcy5wdXNoKG5ldyBPcHRpb25hbElPU0RlcGxveUNvbW1hbmRDaGVjaygpKTtcblxuZXhwb3J0IHtcbiAgZml4ZXMsXG4gIFhjb2RlQ2hlY2ssXG4gIFhjb2RlQ21kTGluZVRvb2xzQ2hlY2ssXG4gIERldlRvb2xzU2VjdXJpdHlDaGVjayxcbiAgT3B0aW9uYWxJZGJDb21tYW5kQ2hlY2ssXG4gIE9wdGlvbmFsQXBwbGVzaW11dGlsc0NvbW1hbmRDaGVjayxcbiAgT3B0aW9uYWxJT1NEZXBsb3lDb21tYW5kQ2hlY2ssXG4gIE9wdGlvbmFsTHlmdENvbW1hbmRDaGVjayxcbn07XG5leHBvcnQgZGVmYXVsdCBjaGVja3M7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUEsSUFBSUEsTUFBTSxHQUFHLEVBQWI7QUFDQSxJQUFJQyxLQUFLLEdBQUcsRUFBWjs7O0FBR0EsTUFBTUMsVUFBTixTQUF5QkMsbUJBQXpCLENBQXFDO0VBQ3JCLE1BQVJDLFFBQVEsR0FBRztJQUNmLElBQUlDLFNBQUo7O0lBQ0EsSUFBSTtNQUVGLE1BQU0sSUFBQUMsa0JBQUEsRUFBSyxPQUFMLEVBQWMsQ0FBQyxRQUFELEVBQVcsTUFBWCxDQUFkLENBQU47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